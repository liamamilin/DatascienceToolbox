<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Predictive analytics | Data Science toolbox</title>
  <meta name="description" content="这本书是一本工具书, 里面总结了使用R进行数据科学相关工作常用的一些工具." />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Predictive analytics | Data Science toolbox" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="这本书是一本工具书, 里面总结了使用R进行数据科学相关工作常用的一些工具." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Predictive analytics | Data Science toolbox" />
  
  <meta name="twitter:description" content="这本书是一本工具书, 里面总结了使用R进行数据科学相关工作常用的一些工具." />
  

<meta name="author" content="米霖" />


<meta name="date" content="2024-02-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="diagnostic-analytics-1.html"/>
<link rel="next" href="prescriptive-analytics-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data science Toolboxe</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> url: your book url like https://bookdown.org/yihui/bookdown</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#ddpp"><i class="fa fa-check"></i><b>1.1</b> DDPP</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#descriptive-analytics"><i class="fa fa-check"></i><b>1.1.1</b> Descriptive analytics</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#diagnostic-analytics"><i class="fa fa-check"></i><b>1.1.2</b> Diagnostic analytics</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#predictive-analytics"><i class="fa fa-check"></i><b>1.1.3</b> Predictive analytics</a></li>
<li class="chapter" data-level="1.1.4" data-path="index.html"><a href="index.html#prescriptive-analytics"><i class="fa fa-check"></i><b>1.1.4</b> prescriptive analytics</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#关于ddpp-的简单总结"><i class="fa fa-check"></i><b>1.2</b> 关于DDPP 的简单总结</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="descriptive-analytics-1.html"><a href="descriptive-analytics-1.html"><i class="fa fa-check"></i><b>2</b> Descriptive analytics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="descriptive-analytics-1.html"><a href="descriptive-analytics-1.html#ggstatsplot"><i class="fa fa-check"></i><b>2.1</b> ggstatsplot</a></li>
<li class="chapter" data-level="2.2" data-path="descriptive-analytics-1.html"><a href="descriptive-analytics-1.html#crosstable"><i class="fa fa-check"></i><b>2.2</b> crosstable</a></li>
<li class="chapter" data-level="2.3" data-path="descriptive-analytics-1.html"><a href="descriptive-analytics-1.html#附录"><i class="fa fa-check"></i><b>2.3</b> 附录</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="diagnostic-analytics-1.html"><a href="diagnostic-analytics-1.html"><i class="fa fa-check"></i><b>3</b> Diagnostic analytics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="diagnostic-analytics-1.html"><a href="diagnostic-analytics-1.html#工具箱"><i class="fa fa-check"></i><b>3.1</b> 工具箱</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="diagnostic-analytics-1.html"><a href="diagnostic-analytics-1.html#分析方法"><i class="fa fa-check"></i><b>3.1.1</b> 分析方法</a></li>
<li class="chapter" data-level="3.1.2" data-path="diagnostic-analytics-1.html"><a href="diagnostic-analytics-1.html#分析工具"><i class="fa fa-check"></i><b>3.1.2</b> 分析工具</a></li>
<li class="chapter" data-level="3.1.3" data-path="diagnostic-analytics-1.html"><a href="diagnostic-analytics-1.html#分组图形"><i class="fa fa-check"></i><b>3.1.3</b> 分组图形</a></li>
<li class="chapter" data-level="3.1.4" data-path="diagnostic-analytics-1.html"><a href="diagnostic-analytics-1.html#列联表分析"><i class="fa fa-check"></i><b>3.1.4</b> 列联表分析</a></li>
<li class="chapter" data-level="3.1.5" data-path="diagnostic-analytics-1.html"><a href="diagnostic-analytics-1.html#卡方和t-检验"><i class="fa fa-check"></i><b>3.1.5</b> 卡方和t 检验</a></li>
<li class="chapter" data-level="3.1.6" data-path="diagnostic-analytics-1.html"><a href="diagnostic-analytics-1.html#异常值检验"><i class="fa fa-check"></i><b>3.1.6</b> 异常值检验</a></li>
<li class="chapter" data-level="3.1.7" data-path="diagnostic-analytics-1.html"><a href="diagnostic-analytics-1.html#关联规则"><i class="fa fa-check"></i><b>3.1.7</b> 关联规则</a></li>
<li class="chapter" data-level="3.1.8" data-path="diagnostic-analytics-1.html"><a href="diagnostic-analytics-1.html#k-means"><i class="fa fa-check"></i><b>3.1.8</b> k means</a></li>
<li class="chapter" data-level="3.1.9" data-path="diagnostic-analytics-1.html"><a href="diagnostic-analytics-1.html#层级聚类"><i class="fa fa-check"></i><b>3.1.9</b> 层级聚类</a></li>
<li class="chapter" data-level="3.1.10" data-path="diagnostic-analytics-1.html"><a href="diagnostic-analytics-1.html#dbscan"><i class="fa fa-check"></i><b>3.1.10</b> DBSCAN</a></li>
<li class="chapter" data-level="3.1.11" data-path="diagnostic-analytics-1.html"><a href="diagnostic-analytics-1.html#woe-分析"><i class="fa fa-check"></i><b>3.1.11</b> WOE 分析</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="predictive-analytics-1.html"><a href="predictive-analytics-1.html"><i class="fa fa-check"></i><b>4</b> Predictive analytics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="predictive-analytics-1.html"><a href="predictive-analytics-1.html#工具箱-1"><i class="fa fa-check"></i><b>4.1</b> 工具箱</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="predictive-analytics-1.html"><a href="predictive-analytics-1.html#glm"><i class="fa fa-check"></i><b>4.1.1</b> GLM</a></li>
<li class="chapter" data-level="4.1.2" data-path="predictive-analytics-1.html"><a href="predictive-analytics-1.html#xgboost"><i class="fa fa-check"></i><b>4.1.2</b> xgboost</a></li>
<li class="chapter" data-level="4.1.3" data-path="predictive-analytics-1.html"><a href="predictive-analytics-1.html#dt"><i class="fa fa-check"></i><b>4.1.3</b> DT</a></li>
<li class="chapter" data-level="4.1.4" data-path="predictive-analytics-1.html"><a href="predictive-analytics-1.html#naive-bayes"><i class="fa fa-check"></i><b>4.1.4</b> Naive Bayes</a></li>
<li class="chapter" data-level="4.1.5" data-path="predictive-analytics-1.html"><a href="predictive-analytics-1.html#times-series"><i class="fa fa-check"></i><b>4.1.5</b> times series</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="predictive-analytics-1.html"><a href="predictive-analytics-1.html#特征衍生的常用方法"><i class="fa fa-check"></i><b>4.2</b> 特征衍生的常用方法</a></li>
<li class="chapter" data-level="4.3" data-path="predictive-analytics-1.html"><a href="predictive-analytics-1.html#特征衍生方法"><i class="fa fa-check"></i><b>4.3</b> 特征衍生方法</a></li>
<li class="chapter" data-level="4.4" data-path="predictive-analytics-1.html"><a href="predictive-analytics-1.html#做数据科学的工作需要了解业务.如何了解业务"><i class="fa fa-check"></i><b>4.4</b> 做数据科学的工作，需要了解业务.如何了解业务？</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="prescriptive-analytics-1.html"><a href="prescriptive-analytics-1.html"><i class="fa fa-check"></i><b>5</b> prescriptive analytics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="prescriptive-analytics-1.html"><a href="prescriptive-analytics-1.html#工具"><i class="fa fa-check"></i><b>5.1</b> 工具</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="prescriptive-analytics-1.html"><a href="prescriptive-analytics-1.html#lpsolve-线性规划"><i class="fa fa-check"></i><b>5.1.1</b> 1. lpSolve 线性规划</a></li>
<li class="chapter" data-level="5.1.2" data-path="prescriptive-analytics-1.html"><a href="prescriptive-analytics-1.html#整数规划"><i class="fa fa-check"></i><b>5.1.2</b> 整数规划</a></li>
<li class="chapter" data-level="5.1.3" data-path="prescriptive-analytics-1.html"><a href="prescriptive-analytics-1.html#二次规划"><i class="fa fa-check"></i><b>5.1.3</b> 二次规划</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="prescriptive-analytics-1.html"><a href="prescriptive-analytics-1.html#多目标规划"><i class="fa fa-check"></i><b>5.2</b> 多目标规划</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/liamamilin" target="blank">米霖 Github</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science toolbox</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="predictive-analytics-1" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Predictive analytics<a href="predictive-analytics-1.html#predictive-analytics-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="工具箱-1" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> 工具箱<a href="predictive-analytics-1.html#工具箱-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>各种统计模型 : 逻辑回归</li>
<li>各种机器学习模型: xgboost</li>
</ol>
<p>由于数据科学通常希望强解释性, 因此常常会使用可解释性强的模型或者使用可解释机器学习相关的工具来解释模型.</p>
<div id="glm" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> GLM<a href="predictive-analytics-1.html#glm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>逻辑回归（Logistic Regression）是一种统计学习方法，用于解决二分类问题，即将数据分为两个不同的类别。尽管它包含”回归”这个名词，但实际上它是一种分类算法，用于预测二元输出（通常是0或1）。</p>
<p>逻辑回归的优点和特点包括：</p>
<ol style="list-style-type: decimal">
<li><p><strong>简单和高效：</strong> 逻辑回归是一个非常简单的模型，容易理解和实现。训练速度快，适用于大规模数据。</p></li>
<li><p><strong>可解释性：</strong> 逻辑回归的系数可以用来解释特征对分类结果的影响。这使得逻辑回归在解释性要求高的应用中很有用。</p></li>
<li><p><strong>适用性广泛：</strong> 逻辑回归可以用于处理二分类问题，也可以通过一些变种扩展到多分类问题。它广泛应用于医学、生物学、社会科学、金融等领域。</p></li>
<li><p><strong>对异常值鲁棒：</strong> 逻辑回归对异常值的影响较小，因为它使用的是逻辑函数，而不是线性函数。</p></li>
</ol>
<p>尽管逻辑回归在许多领域中都有出色的表现，但它也有一些限制，包括：</p>
<ul>
<li>它通常只能处理线性可分问题，对于非线性问题需要额外的工作，如特征工程或使用核技巧。</li>
<li>对于高维数据，可能需要正则化来防止过拟合。</li>
<li>逻辑回归不是一个强大的模型，不能捕捉复杂的数据关系。</li>
</ul>
<p>总之，逻辑回归是一个常用的分类算法，特别适用于简单的分类问题和解释性要求高的场景。在选择分类算法时，应根据具体问题和数据特性来决定是否使用逻辑回归或其他更复杂的模型。</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="predictive-analytics-1.html#cb1-1" tabindex="-1"></a><span class="co"># 创建示例数据集</span></span>
<span id="cb1-2"><a href="predictive-analytics-1.html#cb1-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-3"><a href="predictive-analytics-1.html#cb1-3" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-4"><a href="predictive-analytics-1.html#cb1-4" tabindex="-1"></a>  <span class="at">Target =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-5"><a href="predictive-analytics-1.html#cb1-5" tabindex="-1"></a>  <span class="at">Feature1 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb1-6"><a href="predictive-analytics-1.html#cb1-6" tabindex="-1"></a>  <span class="at">Feature2 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb1-7"><a href="predictive-analytics-1.html#cb1-7" tabindex="-1"></a>)</span>
<span id="cb1-8"><a href="predictive-analytics-1.html#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="predictive-analytics-1.html#cb1-9" tabindex="-1"></a><span class="co"># 查看前几行数据</span></span>
<span id="cb1-10"><a href="predictive-analytics-1.html#cb1-10" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<pre><code>##   Target    Feature1   Feature2
## 1      0  0.25331851  0.7877388
## 2      0 -0.02854676  0.7690422
## 3      0 -0.04287046  0.3322026
## 4      1  1.36860228 -1.0083766
## 5      0 -0.22577099 -0.1194526
## 6      1  1.51647060 -0.2803953</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="predictive-analytics-1.html#cb3-1" tabindex="-1"></a><span class="co"># 分割数据集为训练集和测试集</span></span>
<span id="cb3-2"><a href="predictive-analytics-1.html#cb3-2" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), <span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(data))</span>
<span id="cb3-3"><a href="predictive-analytics-1.html#cb3-3" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb3-4"><a href="predictive-analytics-1.html#cb3-4" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb3-5"><a href="predictive-analytics-1.html#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="predictive-analytics-1.html#cb3-6" tabindex="-1"></a><span class="co"># 构建逻辑回归模型</span></span>
<span id="cb3-7"><a href="predictive-analytics-1.html#cb3-7" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(Target <span class="sc">~</span> Feature1 <span class="sc">+</span> Feature2, <span class="at">data =</span> train_data, <span class="at">family =</span> binomial)</span>
<span id="cb3-8"><a href="predictive-analytics-1.html#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="predictive-analytics-1.html#cb3-9" tabindex="-1"></a><span class="co"># 查看模型摘要</span></span>
<span id="cb3-10"><a href="predictive-analytics-1.html#cb3-10" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Target ~ Feature1 + Feature2, family = binomial, 
##     data = train_data)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.1489  -0.9967  -0.9181   1.3205   1.6067  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)  -0.4678     0.2470  -1.894   0.0582 .
## Feature1      0.1083     0.2489   0.435   0.6636  
## Feature2     -0.1930     0.2879  -0.671   0.5025  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 93.351  on 69  degrees of freedom
## Residual deviance: 92.615  on 67  degrees of freedom
## AIC: 98.615
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="predictive-analytics-1.html#cb5-1" tabindex="-1"></a><span class="co"># 预测</span></span>
<span id="cb5-2"><a href="predictive-analytics-1.html#cb5-2" tabindex="-1"></a>predicted_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> test_data, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb5-3"><a href="predictive-analytics-1.html#cb5-3" tabindex="-1"></a>predicted_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predicted_prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb5-4"><a href="predictive-analytics-1.html#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="predictive-analytics-1.html#cb5-5" tabindex="-1"></a><span class="co"># 模型评估</span></span>
<span id="cb5-6"><a href="predictive-analytics-1.html#cb5-6" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(test_data<span class="sc">$</span>Target, predicted_class)</span>
<span id="cb5-7"><a href="predictive-analytics-1.html#cb5-7" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(confusion_matrix)) <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix)</span>
<span id="cb5-8"><a href="predictive-analytics-1.html#cb5-8" tabindex="-1"></a><span class="fu">print</span>(confusion_matrix)</span></code></pre></div>
<pre><code>##    predicted_class
##      0
##   0 14
##   1 16</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="predictive-analytics-1.html#cb7-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Accuracy:&quot;</span>, accuracy))</span></code></pre></div>
<pre><code>## [1] &quot;Accuracy: 0.466666666666667&quot;</code></pre>
</div>
<div id="xgboost" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> xgboost<a href="predictive-analytics-1.html#xgboost" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>XGBoost（Extreme Gradient Boosting）是一种广泛用于机器学习和数据分析的强大而高效的算法。它是一种基于梯度提升框架的机器学习算法，专门设计用于解决分类和回归问题，以及排序、推荐和异常检测等任务。以下是关于XGBoost的一些关键特点：</p>
<ol style="list-style-type: decimal">
<li><p><strong>梯度提升：</strong> XGBoost是一种梯度提升算法，它通过迭代训练多个弱学习器（通常是决策树），然后将它们组合成一个强学习器，以提高模型的性能。</p></li>
<li><p><strong>正则化：</strong> XGBoost支持L1和L2正则化，以帮助防止过拟合，提高模型的泛化能力。</p></li>
<li><p><strong>自动特征选择：</strong> XGBoost可以自动选择重要的特征，有助于减小模型的维度，提高训练和预测效率。</p></li>
<li><p><strong>缺失值处理：</strong> XGBoost能够处理数据中的缺失值，无需手动填充或删除缺失数据。</p></li>
<li><p><strong>多种损失函数：</strong> XGBoost支持多种损失函数，包括平方损失（用于回归问题）、对数损失（用于分类问题）、排名损失（用于排序问题）等。</p></li>
<li><p><strong>并行处理：</strong> XGBoost支持并行化处理，可以加快训练速度。它还能够在分布式计算环境中使用。</p></li>
<li><p><strong>自动剪枝：</strong> XGBoost在构建决策树时进行了自动剪枝，有助于防止过拟合。</p></li>
<li><p><strong>特征重要性：</strong> XGBoost提供了特征重要性评估，帮助用户理解哪些特征对于模型的预测最为重要。</p></li>
<li><p><strong>广泛应用：</strong> XGBoost在数据科学竞赛和实际应用中取得了卓越的成绩，成为许多数据科学家和机器学习从业者的首选工具之一。</p></li>
</ol>
<p>总之，XGBoost是一种强大的机器学习算法，适用于各种问题领域，具有出色的性能和鲁棒性。它被广泛用于数据挖掘、预测建模、自然语言处理、计算广告、金融建模和许多其他领域。</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="predictive-analytics-1.html#cb9-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb9-2"><a href="predictive-analytics-1.html#cb9-2" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span>
<span id="cb9-3"><a href="predictive-analytics-1.html#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="predictive-analytics-1.html#cb9-4" tabindex="-1"></a><span class="co"># 创建示例数据集</span></span>
<span id="cb9-5"><a href="predictive-analytics-1.html#cb9-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-6"><a href="predictive-analytics-1.html#cb9-6" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb9-7"><a href="predictive-analytics-1.html#cb9-7" tabindex="-1"></a>  <span class="at">Target =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-8"><a href="predictive-analytics-1.html#cb9-8" tabindex="-1"></a>  <span class="at">Feature1 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb9-9"><a href="predictive-analytics-1.html#cb9-9" tabindex="-1"></a>  <span class="at">Feature2 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb9-10"><a href="predictive-analytics-1.html#cb9-10" tabindex="-1"></a>)</span>
<span id="cb9-11"><a href="predictive-analytics-1.html#cb9-11" tabindex="-1"></a></span>
<span id="cb9-12"><a href="predictive-analytics-1.html#cb9-12" tabindex="-1"></a><span class="co"># 分割数据集为训练集和测试集</span></span>
<span id="cb9-13"><a href="predictive-analytics-1.html#cb9-13" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), <span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(data))</span>
<span id="cb9-14"><a href="predictive-analytics-1.html#cb9-14" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb9-15"><a href="predictive-analytics-1.html#cb9-15" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb9-16"><a href="predictive-analytics-1.html#cb9-16" tabindex="-1"></a></span>
<span id="cb9-17"><a href="predictive-analytics-1.html#cb9-17" tabindex="-1"></a><span class="co"># 将数据转换为 xgb.DMatrix 格式</span></span>
<span id="cb9-18"><a href="predictive-analytics-1.html#cb9-18" tabindex="-1"></a>dtrain <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> <span class="fu">as.matrix</span>(train_data[, <span class="sc">-</span><span class="dv">1</span>]), <span class="at">label =</span> train_data<span class="sc">$</span>Target)</span>
<span id="cb9-19"><a href="predictive-analytics-1.html#cb9-19" tabindex="-1"></a>dtest <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> <span class="fu">as.matrix</span>(test_data[, <span class="sc">-</span><span class="dv">1</span>]), <span class="at">label =</span> test_data<span class="sc">$</span>Target)</span>
<span id="cb9-20"><a href="predictive-analytics-1.html#cb9-20" tabindex="-1"></a></span>
<span id="cb9-21"><a href="predictive-analytics-1.html#cb9-21" tabindex="-1"></a><span class="co"># 设置 xgboost 参数</span></span>
<span id="cb9-22"><a href="predictive-analytics-1.html#cb9-22" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb9-23"><a href="predictive-analytics-1.html#cb9-23" tabindex="-1"></a>  <span class="at">objective =</span> <span class="st">&quot;binary:logistic&quot;</span>,</span>
<span id="cb9-24"><a href="predictive-analytics-1.html#cb9-24" tabindex="-1"></a>  <span class="at">eval_metric =</span> <span class="st">&quot;logloss&quot;</span></span>
<span id="cb9-25"><a href="predictive-analytics-1.html#cb9-25" tabindex="-1"></a>)</span>
<span id="cb9-26"><a href="predictive-analytics-1.html#cb9-26" tabindex="-1"></a></span>
<span id="cb9-27"><a href="predictive-analytics-1.html#cb9-27" tabindex="-1"></a><span class="co"># 训练 xgboost 模型</span></span>
<span id="cb9-28"><a href="predictive-analytics-1.html#cb9-28" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">xgboost</span>(<span class="at">params =</span> params, <span class="at">data =</span> dtrain, <span class="at">nrounds =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1]  train-logloss:0.618925 
## [2]  train-logloss:0.570001 
## [3]  train-logloss:0.531384 
## [4]  train-logloss:0.507963 
## [5]  train-logloss:0.478611 
## [6]  train-logloss:0.455066 
## [7]  train-logloss:0.440272 
## [8]  train-logloss:0.417422 
## [9]  train-logloss:0.399635 
## [10] train-logloss:0.384381</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="predictive-analytics-1.html#cb11-1" tabindex="-1"></a><span class="co"># 预测</span></span>
<span id="cb11-2"><a href="predictive-analytics-1.html#cb11-2" tabindex="-1"></a>predicted_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, dtest)</span>
<span id="cb11-3"><a href="predictive-analytics-1.html#cb11-3" tabindex="-1"></a>predicted_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predicted_prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb11-4"><a href="predictive-analytics-1.html#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="predictive-analytics-1.html#cb11-5" tabindex="-1"></a><span class="co"># 模型评估</span></span>
<span id="cb11-6"><a href="predictive-analytics-1.html#cb11-6" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(test_data<span class="sc">$</span>Target, predicted_class)</span>
<span id="cb11-7"><a href="predictive-analytics-1.html#cb11-7" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(confusion_matrix)) <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix)</span>
<span id="cb11-8"><a href="predictive-analytics-1.html#cb11-8" tabindex="-1"></a><span class="fu">print</span>(confusion_matrix)</span></code></pre></div>
<pre><code>##    predicted_class
##      0  1
##   0  9  5
##   1 13  3</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="predictive-analytics-1.html#cb13-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Accuracy:&quot;</span>, accuracy))</span></code></pre></div>
<pre><code>## [1] &quot;Accuracy: 0.4&quot;</code></pre>
</div>
<div id="dt" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> DT<a href="predictive-analytics-1.html#dt" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>决策树是一种常见的机器学习算法，它基于树形结构进行决策。决策树的原理可以概括如下：</p>
<ol style="list-style-type: decimal">
<li><p><strong>根节点：</strong> 决策树的起始节点称为根节点。根节点包含整个数据集，表示待处理的问题或任务。</p></li>
<li><p><strong>内部节点：</strong> 决策树中的内部节点表示特征或属性，用于将数据集划分成不同的子集。每个内部节点对应一个特征，并包含若干分支，每个分支对应于该特征的一个可能取值。</p></li>
<li><p><strong>分支：</strong> 内部节点与子节点之间的连接称为分支。分支上的条件通常是针对内部节点所代表的特征的取值进行判断。根据条件，数据点被分配到不同的子节点。</p></li>
<li><p><strong>叶子节点：</strong> 叶子节点是决策树的末端节点，不包含子节点。叶子节点包含一个类别标签（用于分类问题）或一个数值（用于回归问题），表示模型对于特定数据点的决策或预测结果。</p></li>
<li><p><strong>分裂条件：</strong> 决策树建立的关键是确定如何划分数据，即选择哪个特征和条件进行分割。这通常涉及使用一些指标（如信息增益、基尼不纯度、均方误差等）来评估分裂的质量。</p></li>
<li><p><strong>递归建树：</strong> 决策树的建立是一个递归过程。从根节点开始，树逐步向下扩展，根据分裂条件将数据集分成子集，直到满足停止条件（例如，达到最大深度、达到最小叶子节点数、分裂不再提高纯度等）。</p></li>
<li><p><strong>预测和分类：</strong> 决策树的使用包括预测和分类。给定一个数据点，从根节点开始，根据特征的条件逐步向下遍历树，最终到达叶子节点。在叶子节点，可以获得相应的预测或分类结果。</p></li>
<li><p><strong>特点和优势：</strong> 决策树具有直观的可解释性，容易理解和可视化。它们适用于各种问题，包括分类和回归。此外，决策树可以用于特征选择，能够自动识别重要的特征。</p></li>
</ol>
<p>决策树的主要缺点之一是它们容易过拟合训练数据，因此可能需要采取剪枝等方法来提高泛化性能。为了解决这个问题，通常使用随机森林和梯度提升树等集成学习方法，它们基于多个决策树的组合来提高模型性能</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="predictive-analytics-1.html#cb15-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb15-2"><a href="predictive-analytics-1.html#cb15-2" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb15-3"><a href="predictive-analytics-1.html#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="predictive-analytics-1.html#cb15-4" tabindex="-1"></a><span class="co"># 创建示例数据集</span></span>
<span id="cb15-5"><a href="predictive-analytics-1.html#cb15-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb15-6"><a href="predictive-analytics-1.html#cb15-6" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-7"><a href="predictive-analytics-1.html#cb15-7" tabindex="-1"></a>  <span class="at">Target =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-8"><a href="predictive-analytics-1.html#cb15-8" tabindex="-1"></a>  <span class="at">Feature1 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb15-9"><a href="predictive-analytics-1.html#cb15-9" tabindex="-1"></a>  <span class="at">Feature2 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb15-10"><a href="predictive-analytics-1.html#cb15-10" tabindex="-1"></a>)</span>
<span id="cb15-11"><a href="predictive-analytics-1.html#cb15-11" tabindex="-1"></a></span>
<span id="cb15-12"><a href="predictive-analytics-1.html#cb15-12" tabindex="-1"></a><span class="co"># 构建决策树模型</span></span>
<span id="cb15-13"><a href="predictive-analytics-1.html#cb15-13" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">rpart</span>(Target <span class="sc">~</span> Feature1 <span class="sc">+</span> Feature2, <span class="at">data =</span> data, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb15-14"><a href="predictive-analytics-1.html#cb15-14" tabindex="-1"></a></span>
<span id="cb15-15"><a href="predictive-analytics-1.html#cb15-15" tabindex="-1"></a><span class="co"># 可视化决策树</span></span>
<span id="cb15-16"><a href="predictive-analytics-1.html#cb15-16" tabindex="-1"></a><span class="fu">plot</span>(model)</span>
<span id="cb15-17"><a href="predictive-analytics-1.html#cb15-17" tabindex="-1"></a><span class="fu">text</span>(model)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="predictive-analytics-1.html#cb16-1" tabindex="-1"></a><span class="co"># 预测</span></span>
<span id="cb16-2"><a href="predictive-analytics-1.html#cb16-2" tabindex="-1"></a>predicted_class <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> data, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb16-3"><a href="predictive-analytics-1.html#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="predictive-analytics-1.html#cb16-4" tabindex="-1"></a><span class="co"># 模型评估</span></span>
<span id="cb16-5"><a href="predictive-analytics-1.html#cb16-5" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(data<span class="sc">$</span>Target, predicted_class)</span>
<span id="cb16-6"><a href="predictive-analytics-1.html#cb16-6" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(confusion_matrix)) <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix)</span>
<span id="cb16-7"><a href="predictive-analytics-1.html#cb16-7" tabindex="-1"></a><span class="fu">print</span>(confusion_matrix)</span></code></pre></div>
<pre><code>##    predicted_class
##      0  1
##   0 47 10
##   1 18 25</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="predictive-analytics-1.html#cb18-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Accuracy:&quot;</span>, accuracy))</span></code></pre></div>
<pre><code>## [1] &quot;Accuracy: 0.72&quot;</code></pre>
</div>
<div id="naive-bayes" class="section level3 hasAnchor" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Naive Bayes<a href="predictive-analytics-1.html#naive-bayes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>朴素贝叶斯（Naive Bayes）是一种基于贝叶斯定理的统计分类算法，它常用于文本分类、垃圾邮件过滤、情感分析等任务。</p>
<p>朴素贝叶斯算法的分类过程如下：</p>
<ol style="list-style-type: decimal">
<li><p><strong>计算先验概率：</strong> 计算每个类别的先验概率，即在没有任何特征信息的情况下，各个类别出现的概率。这通常是通过训练数据集中每个类别的样本数量来估计的。</p></li>
<li><p><strong>计算似然概率：</strong> 对于每个特征，计算在每个类别下该特征的条件概率。这涉及到计算在给定类别下特征的分布，可以是高斯分布、多项分布等，具体取决于特征的性质。</p></li>
<li><p><strong>计算后验概率：</strong> 利用贝叶斯定理，结合先验概率和似然概率，计算在给定特征下每个类别的后验概率。</p></li>
<li><p><strong>分类决策：</strong> 对于新的样本，将其特征代入后验概率的计算中，选择具有最高后验概率的类别作为分类结果。这通常使用最大后验概率准则来实现。</p></li>
</ol>
<p>朴素贝叶斯的”朴素”之处在于它对特征之间的独立性进行了极强的假设，因此它可能在某些情况下表现不佳，特别是当特征之间存在相关性时。然而，它通常具有简单、快速、对小样本数据有效的优点，因此在许多实际应用中仍然广泛使用。</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="predictive-analytics-1.html#cb20-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb20-2"><a href="predictive-analytics-1.html#cb20-2" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb20-3"><a href="predictive-analytics-1.html#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a href="predictive-analytics-1.html#cb20-4" tabindex="-1"></a><span class="co"># 创建示例数据集</span></span>
<span id="cb20-5"><a href="predictive-analytics-1.html#cb20-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb20-6"><a href="predictive-analytics-1.html#cb20-6" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-7"><a href="predictive-analytics-1.html#cb20-7" tabindex="-1"></a>  <span class="at">Target =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-8"><a href="predictive-analytics-1.html#cb20-8" tabindex="-1"></a>  <span class="at">Feature1 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb20-9"><a href="predictive-analytics-1.html#cb20-9" tabindex="-1"></a>  <span class="at">Feature2 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb20-10"><a href="predictive-analytics-1.html#cb20-10" tabindex="-1"></a>)</span>
<span id="cb20-11"><a href="predictive-analytics-1.html#cb20-11" tabindex="-1"></a></span>
<span id="cb20-12"><a href="predictive-analytics-1.html#cb20-12" tabindex="-1"></a><span class="co"># 构建朴素贝叶斯模型</span></span>
<span id="cb20-13"><a href="predictive-analytics-1.html#cb20-13" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">naiveBayes</span>(Target <span class="sc">~</span> ., <span class="at">data =</span> data)</span>
<span id="cb20-14"><a href="predictive-analytics-1.html#cb20-14" tabindex="-1"></a></span>
<span id="cb20-15"><a href="predictive-analytics-1.html#cb20-15" tabindex="-1"></a><span class="co"># 打印模型摘要</span></span>
<span id="cb20-16"><a href="predictive-analytics-1.html#cb20-16" tabindex="-1"></a><span class="fu">print</span>(model)</span></code></pre></div>
<pre><code>## 
## Naive Bayes Classifier for Discrete Predictors
## 
## Call:
## naiveBayes.default(x = X, y = Y, laplace = laplace)
## 
## A-priori probabilities:
## Y
##    A    B 
## 0.57 0.43 
## 
## Conditional probabilities:
##    Feature1
## Y          [,1]     [,2]
##   A -0.05352413 0.932157
##   B -0.05404030 1.017455
## 
##    Feature2
## Y          [,1]      [,2]
##   A  0.09709167 0.9391056
##   B -0.09348628 0.9287393</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="predictive-analytics-1.html#cb22-1" tabindex="-1"></a><span class="co"># 预测</span></span>
<span id="cb22-2"><a href="predictive-analytics-1.html#cb22-2" tabindex="-1"></a>predicted_class <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> data)</span>
<span id="cb22-3"><a href="predictive-analytics-1.html#cb22-3" tabindex="-1"></a></span>
<span id="cb22-4"><a href="predictive-analytics-1.html#cb22-4" tabindex="-1"></a><span class="co"># 模型评估</span></span>
<span id="cb22-5"><a href="predictive-analytics-1.html#cb22-5" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(data<span class="sc">$</span>Target, predicted_class)</span>
<span id="cb22-6"><a href="predictive-analytics-1.html#cb22-6" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(confusion_matrix)) <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix)</span>
<span id="cb22-7"><a href="predictive-analytics-1.html#cb22-7" tabindex="-1"></a><span class="fu">print</span>(confusion_matrix)</span></code></pre></div>
<pre><code>##    predicted_class
##      A  B
##   A 53  4
##   B 37  6</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="predictive-analytics-1.html#cb24-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Accuracy:&quot;</span>, accuracy))</span></code></pre></div>
<pre><code>## [1] &quot;Accuracy: 0.59&quot;</code></pre>
</div>
<div id="times-series" class="section level3 hasAnchor" number="4.1.5">
<h3><span class="header-section-number">4.1.5</span> times series<a href="predictive-analytics-1.html#times-series" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Prophet 是由 Facebook 开发的一个开源的时间序列预测工具，旨在简化时间序列预测的流程，适用于具有强烈季节性和趋势性的数据。Prophet 提供了一个直观、灵活的接口，可以自动检测数据中的季节性模式、假期效应等，并生成高质量的预测结果。</p>
<p>Prophet 的主要特点包括：</p>
<p>自动化：Prophet 具有自适应性，可以自动检测和处理季节性、趋势性等特征，无需手动指定模型参数。
灵活性：Prophet 提供了灵活的模型定制选项，用户可以根据需要添加自定义的节假日效应、调整季节性和趋势性参数等。
容错性：Prophet 对于缺失值和异常值具有较强的容错性，可以在数据中存在一些缺失值或异常值的情况下生成可靠的预测结果。</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="predictive-analytics-1.html#cb26-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb26-2"><a href="predictive-analytics-1.html#cb26-2" tabindex="-1"></a><span class="fu">library</span>(prophet)</span></code></pre></div>
<pre><code>## Loading required package: Rcpp</code></pre>
<pre><code>## Loading required package: rlang</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="predictive-analytics-1.html#cb29-1" tabindex="-1"></a><span class="co"># 创建示例数据集</span></span>
<span id="cb29-2"><a href="predictive-analytics-1.html#cb29-2" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">&quot;2022-01-01&quot;</span>), <span class="at">by =</span> <span class="st">&quot;day&quot;</span>, <span class="at">length.out =</span> <span class="dv">365</span>)</span>
<span id="cb29-3"><a href="predictive-analytics-1.html#cb29-3" tabindex="-1"></a>sales <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">+</span> <span class="dv">10</span> <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">365</span>)) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">365</span>)</span>
<span id="cb29-4"><a href="predictive-analytics-1.html#cb29-4" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-5"><a href="predictive-analytics-1.html#cb29-5" tabindex="-1"></a>  <span class="at">ds =</span> dates,</span>
<span id="cb29-6"><a href="predictive-analytics-1.html#cb29-6" tabindex="-1"></a>  <span class="at">y =</span> sales</span>
<span id="cb29-7"><a href="predictive-analytics-1.html#cb29-7" tabindex="-1"></a>)</span>
<span id="cb29-8"><a href="predictive-analytics-1.html#cb29-8" tabindex="-1"></a></span>
<span id="cb29-9"><a href="predictive-analytics-1.html#cb29-9" tabindex="-1"></a><span class="co"># 创建并拟合 Prophet 模型</span></span>
<span id="cb29-10"><a href="predictive-analytics-1.html#cb29-10" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">prophet</span>(data)</span></code></pre></div>
<pre><code>## Disabling yearly seasonality. Run prophet with yearly.seasonality=TRUE to override this.</code></pre>
<pre><code>## Disabling daily seasonality. Run prophet with daily.seasonality=TRUE to override this.</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="predictive-analytics-1.html#cb32-1" tabindex="-1"></a><span class="co"># 生成未来时间点的预测</span></span>
<span id="cb32-2"><a href="predictive-analytics-1.html#cb32-2" tabindex="-1"></a>future <span class="ot">&lt;-</span> <span class="fu">make_future_dataframe</span>(model, <span class="at">periods =</span> <span class="dv">30</span>)</span>
<span id="cb32-3"><a href="predictive-analytics-1.html#cb32-3" tabindex="-1"></a>forecast <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, future)</span>
<span id="cb32-4"><a href="predictive-analytics-1.html#cb32-4" tabindex="-1"></a></span>
<span id="cb32-5"><a href="predictive-analytics-1.html#cb32-5" tabindex="-1"></a><span class="co"># 可视化预测结果</span></span>
<span id="cb32-6"><a href="predictive-analytics-1.html#cb32-6" tabindex="-1"></a> </span>
<span id="cb32-7"><a href="predictive-analytics-1.html#cb32-7" tabindex="-1"></a><span class="fu">plot</span>(model,forecast)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
</div>
<div id="特征衍生的常用方法" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> 特征衍生的常用方法<a href="predictive-analytics-1.html#特征衍生的常用方法" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>特征衍生角度</p>
<ol style="list-style-type: decimal">
<li>计数：带过多少次款，有多少消费记录，有多少。。。</li>
<li>求和/累计：消费总金额</li>
<li>占比：贷款额度与年收入的占比</li>
<li>时间/时间差：第一次开户距今的时长 . 提取年月日</li>
<li>波动率：过去三年内每一份工作的时间标准差</li>
<li>多项式展开 : 二次项, 三次项</li>
<li>基于专业知识: 例如金融指标</li>
<li>文本特征衍生 : 文本长度, 关键词频率</li>
<li>窗口特征 : 近7天平均收入</li>
</ol>
</div>
<div id="特征衍生方法" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> 特征衍生方法<a href="predictive-analytics-1.html#特征衍生方法" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>特征衍生是特征工程的一部分，用于从原始特征中创建新特征。以下是一些特征衍生的常见方法：</p>
<ol style="list-style-type: decimal">
<li><p><strong>多项式特征 (Polynomial Features)</strong>:</p>
<ul>
<li>基于原始特征的多项式展开，例如将二次、三次多项式特征添加到数据中，以建模非线性关系。</li>
</ul></li>
<li><p><strong>交叉特征 (Interaction Features)</strong>:</p>
<ul>
<li>创建新特征，基于两个或多个原始特征的交互作用，以便更好地捕捉特征之间的关系。</li>
</ul></li>
<li><p><strong>指数变换 (Exponential Transformation)</strong>:</p>
<ul>
<li>将特征进行指数转换，如对数、指数等，以改变数据的分布和尺度。</li>
</ul></li>
<li><p><strong>离散化 (Discretization)</strong>:</p>
<ul>
<li>将连续特征分成离散区间，创建有序类别特征，以捕捉非线性关系。</li>
</ul></li>
<li><p><strong>时间特征提取 (Time Feature Extraction)</strong>:</p>
<ul>
<li>从时间戳数据中提取年、月、日、季度、周几等时间相关特征。</li>
</ul></li>
<li><p><strong>基于领域知识的特征 (Domain-Specific Features)</strong>:</p>
<ul>
<li>利用领域专业知识创建新的特征，如金融领域的金融指标。</li>
</ul></li>
<li><p><strong>文本特征衍生 (Text Feature Derivation)</strong>:</p>
<ul>
<li>从文本数据中提取有关文本长度、文本内容、关键词频率等信息作为新特征。</li>
</ul></li>
<li><p><strong>组合特征 (Composite Features)</strong>:</p>
<ul>
<li>创建特征组合，通过连接或加权多个特征，例如平均、求和、加权平均等。</li>
</ul></li>
<li><p><strong>图像特征提取 (Image Feature Extraction)</strong>:</p>
<ul>
<li>使用计算机视觉技术从图像数据中提取特征，如颜色直方图、纹理特征等。</li>
</ul></li>
<li><p><strong>滞后特征 (Lag Features)</strong>:</p>
<ul>
<li>对时间序列数据创建滞后版本，以考虑历史信息的影响。</li>
</ul></li>
<li><p><strong>窗口统计特征 (Window Statistics Features)</strong>:</p>
<ul>
<li>使用移动窗口计算统计数据，例如移动平均、滚动标准差等。</li>
</ul></li>
<li><p><strong>累计特征 (Cumulative Features)</strong>:</p>
<ul>
<li>创建累积统计特征，例如累积和、累积平均值等。</li>
</ul></li>
<li><p><strong>频率特征 (Frequency Features)</strong>:</p>
<ul>
<li>对于时间序列数据，可以创建频率域特征，如傅里叶变换。</li>
</ul></li>
<li><p><strong>特征交叉滞后 (Feature Cross-Lag)</strong>:</p>
<ul>
<li>对时间序列数据中的多个特征创建滞后交叉特征。</li>
</ul></li>
<li><p><strong>平均数编码 (Mean Encoding)</strong>:</p>
<ul>
<li>使用目标变量的均值或其他统计量对分类特征进行编码。</li>
</ul></li>
</ol>
<p>特征衍生通常需要根据问题的性质、领域知识和数据类型进行选择。它们可以帮助机器学习模型更好地捕捉数据中的模式和关系，提高模型性能。</p>
</div>
<div id="做数据科学的工作需要了解业务.如何了解业务" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> 做数据科学的工作，需要了解业务.如何了解业务？<a href="predictive-analytics-1.html#做数据科学的工作需要了解业务.如何了解业务" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>商业方面无非，产品和用户。</p>
<p>不同业务，都有衡量业务的指标，例如销售额，客户价值。分析就是分不同的维度去看这些指标。</p>
<p>关注与产品和用户的相关指标，然后分不同的维度去看。</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="diagnostic-analytics-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="prescriptive-analytics-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03-parts.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
